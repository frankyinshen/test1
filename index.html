<!DOCTYPE\\^$*+?.()|[\]{}]/g, '\\$&')})\\b`, 'gi'); return sentence.replace(regex, '<span class="highlight">$1</span>'); }
        
        function displayWord html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8() {
            if (state.autoPlayTimeout) clearTimeout(state.autoPlayTimeout);
            if (state.currentWordIndex >= state.studyList.length) { 
                if (state.currentMode === 'beginner' && state.beginnerUnfamiliar.length > 0) {
                     alert(`本轮结束！还有 ${state.beginnerUnfamiliar.length} 个不熟悉的单词，系统已自动打乱顺序，进入下一轮复习。`);
                     state.studyList = state.beginnerUnfamiliar.sort(() => Math.random">
    <meta name="viewport" content="width=device-width, initial-scale=1.0() - 0.5);
                     state.beginnerUnfamiliar = [];
                     state.currentWordIndex =, maximum-scale=1.0, user-scalable=no">
    <title>单词学习与测试程序 V3.2.5</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
 0;
                     displayWord();
                     return;
                }
                endSession(); return; 
    <style>
        :root {
            --primary-color: #4a90e2;            }
            const word = state.studyList[state.currentWordIndex];
            elements.progressIndicator --primary-hover: #357abd;
            --secondary-color: #f5f7fa.textContent = `进度: ${state.currentWordIndex + 1} / ${state.studyList.length}`;
            elements.wordEnglish.textContent = word.english; elements.wordPhonetic.textContent = word; --font-color: #333;
            --border-color: #dcdfe6;.phonetic; elements.wordChinese.textContent = word.chinese; elements.wordSentence.innerHTML = highlightWordInSentence(word.sentence, word.english); elements.wordTranslation.textContent = word.translation; elements. --light-gray: #f8f9fa; --gray: #6c757d;
wordNotes.textContent = word.notes;
            
            elements.infoItems.forEach(item => item.classList.remove('visible'));
            document.getElementById('toggle-all-btn').textContent = '当前全部显示            --green: #28a745; --green-hover: #218838';
            
            if (state.isGlobalShowAll) {
                elements.infoItems.forEach(;
            --red: #dc3545; --red-hover: #c8233item => item.classList.add('visible'));
                document.getElementById('toggle-all-btn').textContent =3;
            --orange: #fd7e14; --orange-hover: #e370 '当前全部隐藏';
                if (state.currentMode === 'beginner' && state.isAutoAudio) speak(word.english);
            } else {
                 const delay = Number(elements.delayInput.value12;
            --purple: #6f42c1; --purple-hover: #5a);
                 if (state.currentMode === 'beginner') {
                    document.getElementById('info-chinese').359a;
        }
        body, html {
            margin: 0; padding: classList.add('visible'); 
                    document.getElementById('info-sentence').classList.add('visible'); 
                    if (state.isAutoAudio) speak(word.english); 
                 } else if (delay0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, > 0) { 
                    state.autoPlayTimeout = setTimeout(() => speak(word.english), delay "Helvetica Neue", Arial, sans-serif;
            background-color: var(--secondary-color); color: * 1000); 
                 }
            }
        }
        function startSession(word var(--font-color);
            height: 100%;
        }
        .app-containerList, mode, isCategorizedReview = false) {
            state.studyList = [...wordList]; 
            state.currentMode = mode; state.currentWordIndex = 0; state.sessionSubErrors = {
            display: flex; flex-direction: column; height: 100vh;
            max [];
            state.beginnerUnfamiliar = [];
            state.isCategorizedReview = isCategorizedReview;-width: 1000px; margin: 0 auto;
            background-color: white;
            if (!isCategorizedReview) { state.mainSessionErrors = []; }
            if (state.studyList.length === 0) { alert("没有要学习的单词。"); return; }
            
 box-shadow: 0 0 20px rgba(0,0,0,0.05            if (mode === 'beginner') {
                elements.globalShowAllBtn.style.display = 'block);
        }
        .view {
            display: none; flex-direction: column; align-items';
                elements.globalDefaultBtn.style.display = 'block';
                elements.toggleAudioBtn.style.display = 'block';
                state.isAutoAudio = true; 
                updateAudioButtonState();
            } else {
                elements.globalShowAllBtn.style.display = 'none';
                : center;
            height: 100%; padding: 15px 20px;
elements.globalDefaultBtn.style.display = 'none';
                elements.toggleAudioBtn.style.display            box-sizing: border-box; 
            overflow-y: auto;
        }
        . = 'none';
            }
            
            const clone = elements.actionsTemplate.content.cloneNode(view.active { display: flex; }
        .main-content {
            flex-grow: 1true);
            elements.desktopActionsPlaceholder.innerHTML = ''; elements.mobileActionsPlaceholder.innerHTML = '';
            elements.desktopActionsPlaceholder.appendChild(clone);
            elements.mobileActionsPlaceholder.appendChild(elements.actionsTemplate; width: 100%;
            padding-bottom: 120px;
        }
.content.cloneNode(true));
            [elements.desktopActionsPlaceholder, elements.mobileActionsPlaceholder].forEach        #setup-view { justify-content: flex-start; }
        #setup-view h1 {(container => {
                 container.querySelector('#test-mode-buttons').style.display = mode === 'test' ? 'grid' : 'none';
                 container.querySelector('#phonics-mode-buttons').style. color: var(--primary-color); text-align: center; margin-top: 5px; margin-display = mode === 'phonics' ? 'grid' : 'none';
                 container.querySelector('#beginner-bottom: 10px; font-size: 20px; }
        .setup-section {mode-buttons').style.display = mode === 'beginner' ? 'grid' : 'none';
            }); width: 100%; max-width: 500px; margin-bottom: 10
            elements.toggleButtonsPanel.style.display = 'flex';
            document.querySelectorAll('[id^="prev-word-btn"]').forEach(btn => btn.disabled = false);
            switchView('study');
px; }
        
        .inline-input-group {
            display: flex; align-items:            displayWord();
        }
        
        function updateAudioButtonState() {
             elements.toggleAudio center; gap: 10px; margin-bottom: 10px;
        }
        .Btn.textContent = state.isAutoAudio ? '自动发音: 开' : '自动发音: 关';
        }

        function endSession() {
            if (state.isCategorizedReview) {inline-input-group label { margin: 0; color: var(--font-color); font-weight:
                const correctInSubSession = state.studyList.filter(w => !state.sessionSubErrors.some(e => e.english === w.english));
                state.mainSessionErrors = state.mainSession bold; white-space: nowrap; font-size: 15px; }
        .inline-inputErrors.filter(err => !correctInSubSession.some(c => c.english === err.english));-group .input-field { margin: 0; flex-grow: 1; }

        .input
                displayResults(state.mainSessionErrors); switchView('results');
            } else {
                state.mainSessionErrors = [...state.sessionSubErrors]; saveErrorsToHistory(state.mainSessionErrors); display-field {
            width: 100%; padding: 10px; border: 1pxResults(state.mainSessionErrors); switchView('results');
            }
        }
        function nextWord solid var(--border-color);
            border-radius: 8px; font-size: 15() { 
            if (state.currentWordIndex < state.studyList.length - 1) { 
                state.currentWordIndex++; displayWord(); 
            } else { 
                if (statepx; box-sizing: border-box; transition: all 0.2s ease;
        }
.currentMode === 'beginner' && state.beginnerUnfamiliar.length > 0) {
                     alert(        .input-field:focus {
            border-color: var(--primary-color);
            box-`本轮结束！还有 ${state.beginnerUnfamiliar.length} 个不熟悉的单词，系统已自动打乱顺序，进入下一轮复习。`);
                     state.studyList = state.beginnerUnfamiliar.sort(()shadow: 0 0 0 3px rgba(74, 144, 22 => Math.random() - 0.5);
                     state.beginnerUnfamiliar = [];
                     state.currentWordIndex = 0;
                     displayWord();
                } else {
                    endSession(); 
6, 0.2);
            outline: none;
        }
        .tab-nav { display                }
            } 
        }
        function prevWord() { if (state.currentWordIndex >: flex; border-bottom: 1px solid var(--border-color); margin-bottom: 10 0) { state.currentWordIndex--; displayWord(); } }
        function recordError(errorType) { const word = state.studyList[state.currentWordIndex]; if (!state.sessionSubErrors.findpx; }
        .tab-btn {
            padding: 8px 15px;
            border: none; background-color: transparent; font-size: 15px;
            cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s; font-weight:(e => e.english === word.english)) { state.sessionSubErrors.push({ ...word, error 500;
        }
        .tab-btn.active { color: var(--primary-colorType }); } }
        function saveErrorsToHistory(errors) { if (errors.length === 0)); border-bottom-color: var(--primary-color); }
        .tab-content { display: none return; let history = JSON.parse(localStorage.getItem('wordLearner_errorHistory') || '[]'); const newErrors = errors.map(err => ({ ...err, date: new Date().toISOString() })); history = history; }
        .tab-content.active { display: block; }

        /* Server Browser Styles */
        .url-source-toggle { display: flex; justify-content: center; gap: 20px; margin-bottom: 10px; }
        .radio-label { display: flex; align-.concat(newErrors); localStorage.setItem('wordLearner_errorHistory', JSON.stringify(history)); }
        function getErrorsFromHistory(days) { let history = JSON.parse(localStorage.getItem('wordLearner_errorHistory') || '[]'); if (history.length === 0) return []; const now = new Date(); const uniqueWords = new Map(); if (days !== 'all') { const cutoff = new Date(); if (days === 0) { cutoff.setHours(0, 0, 0, 0); } else { cutoff.setDate(now.getDate() - days); } history = history.filter(err => new Date(err.date) >= cutoff); } history.forEach(word => { uniqueWords.set(word.english,items: center; gap: 5px; cursor: pointer; font-size: 14px; color: var(--font-color); }
        
        .server-browser-container {
            border:  word); }); return Array.from(uniqueWords.values()); }
        
        function displayResults(errors) {
            const total = state.studyList.length; const correctCount = total - errors.length; const accuracy = total > 0 ? (correctCount / total) * 100 : 100;
            let encouragement = state.isCategorizedReview ? `太棒了, ${state.userName || '同学'}!` : (accuracy === 100 ? `太完美了, ${state.userName || '同学'}1px solid var(--border-color); border-radius: 8px; overflow: hidden;
            display! 百分百正确，你真是个天才！` : (accuracy >= 90 ? `非常棒, ${state.userName || '同学'}! 成绩优秀！` : `加油, ${state.userName || '同学'}!`));
            elements.resultsTitle.textContent = encouragement;
            if (errors.length === : flex; flex-direction: column; 
            height: 240px; 
            background: #fff;
        }
        .browser-header {
            padding: 8px; background-color: var(--light-gray); border-bottom: 1px solid var(--border-color);
            display: flex; align-items: center; gap: 10px;
        }
        .back0) { elements.resultsSummary.innerHTML = '本次学习所有单词均已掌握！'; elements.errorContainer.innerHTML = ''; elements.exportErrorsBtn.style.display = 'none'; } 
            else {
                elements.resultsSummary.textContent = state.isCategorizedReview ? `还剩下 ${errors.length} 个-btn { padding: 3px 8px; font-size: 12px; cursor: pointer错题需要复习。` : `本次答对 ${correctCount} 个，答错 ${errors.length; white-space: nowrap;}
        .current-path { font-size: 12px; color} 个，正确率 ${accuracy.toFixed(1)}%`;
                elements.exportErrorsBtn.style.display = 'inline-block';
                const errorsByType = { pron_wrong: { title: '读音: var(--gray); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-grow错误', words: [] }, meaning_wrong: { title: '意思错误', words: [] }, all_wrong: 1;}
        
        .browser-search-box {
            padding: 6px 1: { title: '读音、意思均错', words: [] }, phonics_wrong: { title: '拼读错误', words: [] } };
                errors.forEach(err => { if (errorsByType[0px;
            border-bottom: 1px solid var(--border-color);
            background: #err.errorType]) errorsByType[err.errorType].words.push(err); });
                let htmlfff;
        }
        .search-input {
            width: 100%; padding:  = '';
                for (const type in errorsByType) {
                    const group = errorsByType[type];
6px 10px 6px 30px;
            border: 1px solid var(--                    if (group.words.length > 0) { html += `<div class="error-category"><h3><span>${group.title} (${group.words.length}个)</span><button class="btn review-errorborder-color); border-radius: 15px; font-size: 13px; box--group-btn" data-error-type="${type}">复习此类</button></h3><ul class="error-list">${group.words.map(w => `<li class="error-card"><div class="wordsizing: border-box;
            background-image: url("data:image/svg+xml,%3Csvg-header"><span class="word-english">${w.english}</span><span class="word-phonetic">${ xmlns='http://www.w3.org/2000/svg' width='14' heightw.phonetic || ''}</span></div><div class="word-info"><p><strong>中文:</strong> ${='14' viewBox='0 0 24 24' fill='none' stroke='%23w.chinese || 'N/A'}</p><p><strong>例句:</strong> ${highlightWordInSentence(w.sentence, w.english) || 'N/A'}</p></div></li>`).join('')}999' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E</ul></div>`; }
                }
                elements.errorContainer.innerHTML = html;
            }
        }
        
        function getFormattedTimestamp() { const d = new Date(); const pad = (n) => n.toString().padStart(2, '0'); return `${d.getFullYear()}${pad(d.getMonth() +%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16 1)}${pad(d.getDate())}${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}`; }
        function exportErrorsToExcel() { 
            const errors = state.mainSessionErrors; if (errors.length === 0) return; 
            const name = (state.userName || 'User').replace(/[^a-zA-Z0-9]/g, '');
            const map = { pron_wrong: '读音错误', meaning_wrong: '意思错误', all_wrong.65' y2='16.65'%3E%3C/line%3E%: '读音、意思均错', phonics_wrong: '拼读错误' }; 
            const data = errors.map(w => ([ w.id, w.english, w.phonetic, w.3C/svg%3E");
            background-repeat: no-repeat; background-position: 8px center; outline: none;
        }
        .search-input:focus { border-color: var(--primary-color); }

        .server-file-list { flex-grow: 1; overflow-chinese, w.sentence, w.translation, w.notes, map[w.errorType] || '未知y: auto; padding: 0; margin: 0; list-style: none; }
        .'])); 
            const finalData = [ [], ['序号', '英文', '音标', '中文', 'file-item {
            display: flex; align-items: center; padding: 10px 1例句', '例句翻译', '备注', '错误类型'], ...data ]; 
            const ws = XLSX.utils.aoa_to_sheet(finalData); const wb = XLSX.utils.book_new5px;
            border-bottom: 1px solid var(--light-gray); cursor: pointer; transition(); 
            XLSX.utils.book_append_sheet(wb, ws, "Errors"); 
            XLSX.writeFile(wb, `${name || 'User'}Errors${getFormattedTimestamp()}.xlsx`); 
        }
        function createAndDownloadTemplate() {
            const templateData = [ ['说明:', ': background 0.2s;
        }
        .file-item:hover { background-color:...'], ['序号', '英文', '音标', '中文', '例句', '例句翻译', '备注'], [1, 'apple', '/ˈæp.əl/', '苹果', 'An apple a day keeps the doctor away.', '一天一苹果...','...'] ];
            const ws = XLSX.utils.aoa_to_sheet(templateData); const wb = XLSX.utils.book_new(); 
            X #f0f7ff; }
        .file-item:last-child { border-bottom: none; }
        .file-icon { margin-right: 10px; font-size: 16px; width: 20px; text-align: center; }
        .file-name {LSX.utils.book_append_sheet(wb, ws, "单词列表"); 
            const o = XLSX.write(wb, { bookType:'xlsx', type:'array' }); 
            elements.templateLink.href = URL.createObjectURL(new Blob([o], {type:"application/octet-stream"})); font-size: 13px; color: #333; flex-grow: 1; white 
        }
        
        document.querySelectorAll('.tab-btn').forEach(btn => btn.addEventListener('-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .folder-item .file-icon { color: #f7b928; } 
        .excel-item .file-click', (e) => { document.querySelector('.tab-btn.active').classList.remove('active'); document.querySelector('.tab-content.active').classList.remove('active'); e.currentTarget.classList.add('active'); document.getElementById(e.currentTarget.dataset.tab + '-tab').classList.add('active'); }));
icon { color: #217346; } 

        #file-input { display: none; }
        #template-link { display: inline-block; margin-top: 5px; color        elements.nameInput.addEventListener('change', (e) => { state.userName = e.target.value: var(--primary-color); font-weight: 500; font-size: 13px; saveData(); });
        elements.loadUrlBtn.addEventListener('click', () => handleUrlLoad()); 
; }
        
        .loader-container { display: flex; align-items: center; gap:         elements.uploadBtn.addEventListener('click', () => elements.fileInput.click()); 
        elements.fileInput.addEventListener('change', handleFileUpload); 
        elements.sheetSelect.addEventListener('change', (e10px; margin-top: 8px;}
        .loading-status-inline { color: var) => processSheet(e.target.value, document.querySelector('.tab-btn.active').dataset.tab));
        document.querySelectorAll('.mode-btn').forEach(btn => btn.addEventListener('click', (e)(--gray); font-size: 13px; flex-grow: 1; text-align: left => { const mode = e.target.dataset.mode; state.currentMode = mode; document.querySelectorAll('.; margin: 0; }

        #mode-selection-controls { display: none; }
        #mode-btn').forEach(b => b.style.backgroundColor = ''); e.target.style.backgroundColor = 'mode-selection-controls h3 { margin-top: 5px; margin-bottom: 5px;var(--primary-hover)'; if (mode === 'beginner') { activateMobileAudio(); startSession(state.all text-align: center; font-size: 14px; color: var(--gray); }

        Words, 'beginner', false); } else { elements.delaySettings.style.display = 'block'; elements.delayInput.value = state.delaySettings[mode]; } }));
        elements.delayInput.addEventListener('change', (e) => { if (['test', 'phonics'].includes(state.currentMode)) { state.delaySettings[state.currentMode] = parseFloat(e.target.value); saveData(); } });
        elements.startBtn.addEventListener('click', () => { if (!state.currentMode) { alert('请先选择一个模式'); return; } activateMobileAudio(); startSession(state.allWords, state.currentMode,.delay-setting-group { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 10px; }
        .delay-setting-group label { margin: 0; color: var(--gray); font-size: 13px; white- false); });
        
        // --- 核心修复：单独绑定单词点击事件 ---
        const handleWordAreaClickspace: nowrap; }
        #delay-input { width: 60px; text-align: center = (e) => {
             // 阻止冒泡，确保只触发这一次 speak
             e.stopPropagation; padding: 6px; }
        
        .button-group { display: flex; flex-wrap();
             e.preventDefault();
             const word = state.studyList[state.currentWordIndex]?.english;
: wrap; justify-content: center; gap: 10px; margin-top: 10px             if (word) {
                 speak(word);
                 // 顺便复制
                 if (navigator.clipboard && window.isSecureContext) { navigator.clipboard.writeText(word).catch(e => console.; }
        .btn {
            padding: 10px 16px; font-size:error(e)); }
             }
        };
        // 直接绑定，不使用委托
        elements.wordDisplay 15px; font-weight: 600;
            border-radius: 6px;Area.addEventListener('click', handleWordAreaClick);

        views.study.addEventListener('click', (e) cursor: pointer; border: none;
            color: white; letter-spacing: 0.5px; => {
            const target = e.target.closest('button'); if (!target) return;
            

            box-shadow: 0 2px 4px rgba(0,0,0,0.            // V3.1 Global Buttons Logic
            if (target.id === 'toggle-all-btn') { 
                const items = document.querySelectorAll('#study-view .info-item'); 
                const hidden1);
            transition: all 0.15s ease; background-color: var(--primary-color = Array.from(items).some(i => !i.classList.contains('visible')); 
                items.forEach(i => hidden ? i.classList.add('visible') : i.classList.remove('visible')););
        }
        .btn:hover { transform: translateY(-1px); box-shadow: 0 
                target.textContent = hidden ? '全部重置' : '当前全部显示'; 
                return 4px 8px rgba(0,0,0,0.1); }
        .btn:; 
            }
            if (target.id === 'global-show-all-btn') {
                state.isGlobalShowAll = true;
                displayWord();
                return;
            }
            active { transform: translateY(1px); box-shadow: 0 1px 2px rgba(0if (target.id === 'global-default-btn') {
                state.isGlobalShowAll = false;
                displayWord();
                return;
            }
            // V3.2.0 Audio Toggle,0,0,0.1); }
        
        .btn-outline {
            background-color Logic
            if (target.id === 'toggle-audio-btn') {
                state.isAutoAudio: transparent; border: 2px solid var(--border-color);
            color: var(--gray); box = !state.isAutoAudio;
                updateAudioButtonState();
                return;
            }
            
            if (target.id === 'play-btn') { // Explicit Play Button Handler
                 speak(state-shadow: none;
        }
        .btn-outline:hover { background-color: var(--light.studyList[state.currentWordIndex]?.english);
                 return;
            }

            const res = target.dataset.result;
            if (res) { 
                if (res.startsWith('phonics-gray); border-color: var(--gray); transform: none; box-shadow: none; }
        ')) { 
                    if (res === 'phonics_wrong') { recordError(res); speak(state
        .btn-green { background-color: var(--green); } .btn-green:hover { background.studyList[state.currentWordIndex]?.english); } else nextWord(); 
                } else if (-color: var(--green-hover); }
        .btn-red { background-color: var(--redres.startsWith('beginner')) {
                    const word = state.studyList[state.currentWordIndex];
                    if (res === 'beginner_unfamiliar') {
                        if (!state.beginnerUnfamiliar.find(); } .btn-red:hover { background-color: var(--red-hover); }
        .btnw => w.english === word.english)) {
                            state.beginnerUnfamiliar.push(word);
-orange { background-color: var(--orange); } .btn-orange:hover { background-color: var                        }
                    } else if (res === 'beginner_mastered') {
                        state.beginnerUnfamiliar = state.beginnerUnfamiliar.filter(w => w.english !== word.english);
                    }
                    (--orange-hover); }
        .btn-purple { background-color: var(--purple); } .btnnextWord();
                } else { 
                    if (res !== 'correct') recordError(res); next-purple:hover { background-color: var(--purple-hover); }

        #study-view .mainWord(); 
                } 
            } 
            else if (target.matches('[id^="prev-content { display: flex; flex-direction: column; align-items: center; justify-content: flex-word-btn"]')) prevWord(); else if (target.matches('[id^="exit-session-btn"]')) endSession(); else if (target.classList.contains('toggle-btn')) document.getElementById(target.-start; text-align: center; padding-top: 2vh; }
        #progress-indicatordataset.target).classList.toggle('visible');
        });

        elements.errorContainer.addEventListener('click', (e) => { if (e.target.classList.contains('review-error-group-btn')) { { font-size: 16px; color: var(--gray); font-weight: bold; margin- const type = e.target.dataset.errorType; startSession(state.mainSessionErrors.filter(err => err.errorType === type), type === 'phonics_wrong' ? 'phonics' : 'testbottom: 15px; }
        
        .word-display { cursor: pointer; position: relative', true); } });
        elements.exportErrorsBtn.addEventListener('click', exportErrorsToExcel);
        ; user-select: none; -webkit-user-select: none; }
        .word-display:document.getElementById('return-home-from-results-btn').addEventListener('click', () => { elements.modeSelectionControls.style.display = 'none'; if (state.allWords.length > 0) elements.active { opacity: 0.7; }
        .word-display .english { font-size: modeSelectionControls.style.display = 'block'; switchView('setup'); });
        elements.reviewBtn.42px; font-weight: bold; margin-bottom: 4px; line-height: 1addEventListener('click', () => { if (getErrorsFromHistory('all').length === 0) alert('目前.1; }
        .word-display .phonetic { font-size: 20px; color没有错题记录！'); else switchView('reviewOptions'); });
        document.querySelectorAll('.review-range-btn').forEach(btn => btn.addEventListener('click', (e) => { const days = e.target.: var(--gray); }
        
        .info-panel { margin-top: 15px;dataset.days === 'all' ? 'all' : Number(e.target.dataset.days); const list width: 95%; }
        .info-item { background-color: var(--light-gray); = getErrorsFromHistory(days); if (list.length === 0) { alert(`无记录。`); return; } state.allWords = list; elements.welcomeMessage.textContent = `复习 ${list.length border: 1px solid var(--border-color); padding: 12px; border-radius: } 个错题`; elements.modeSelectionControls.style.display = 'block'; switchView('setup'); document.querySelector('.mode-btn[data-mode="test"]').click(); }));
        document.getElementById('back-to-setup-from-review').addEventListener('click', () => switchView('setup'));
        
        function8px; margin-top: 8px; text-align: left; display: none; font-size: 15px; }
        .info-item.visible { display: block; }
        . init() { 
            loadData(); 
            createAndDownloadTemplate(); 
            initTTS(); highlight { color: var(--red); font-weight: bold; }

        .toggle-buttons { display:
            switchView('setup'); 
            
            // Default to server view
            elements.urlSourceRadi flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin: 2os.forEach(r => {
                if (r.value === 'server') { r.checked = true; r.dispatchEvent(new Event('change')); }
            });
        }
        init();
    });
    </script>
</body>
</html>
